<!DOCTYPE html>
<html>
<head>
    <title>Results</title>
    <style>
        .scroll-table {
            max-height: 400px;
            overflow: auto;
            display: block;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            min-width: 600px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h2>Grades for {{ course_name }}</h2>
    <p><strong>Grade Number:</strong> {{ grade_number }}</p>
    <p><strong>Examine Period:</strong> {{ examine_period }}</p>
    <p><strong>Message:</strong> {{ message }}</p>
    <p><strong>Title from Excel:</strong> {{ title }}</p>

    <h3>Statistics</h3>
    <ul>
        <li>Mean: {{ stats.mean }}</li>
        <li>Median: {{ stats.median }}</li>
        <li>Standard Deviation: {{ stats.std }}</li>
    </ul>

    <h3>Grade Distribution</h3>
    <img src="{{ histogram }}" alt="Histogram">

    <h3>Grades Table</h3>
    <div class="scroll-table">
        <table>
            <thead>
                <tr><th>Student ID</th><th>Name</th><th>Grade</th></tr>
            </thead>
            <tbody>
                {% for g in grades %}
                    <tr>
                        <td>{{ g.student_id }}</td>
                        <td>{{ g.name }}</td>
                        <td>{{ g.grade }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>

